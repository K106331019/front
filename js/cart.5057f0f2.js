(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{"7cb4":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-all"},[a("b-row",{staticClass:"w-75 mx-auto mb-2"},[a("b-col",{attrs:{lg:"4"}},[a("p",{staticClass:"cart-list"},[t._v(" 01 "),a("span",[t._v("購物車確認")])])]),a("b-col",{attrs:{lg:"4"}},[a("p",{staticClass:"cart-list"},[t._v(" 02 "),a("span",[t._v("訂單付款方式")])]),a("div",{staticClass:"list-under"})]),a("b-col",{attrs:{lg:"4"}},[a("p",{staticClass:"cart-list"},[t._v(" 03 "),a("span",[t._v("完成訂單")])])])],1),a("b-row",{staticClass:"m-0"},[a("b-col",{staticClass:"p-5",attrs:{lg:"6"}},[a("h2",{staticClass:"text-center"},[t._v("訂單資訊")]),t.show?a("b-form",{staticClass:"w-75 mx-auto mt-3"},[a("b-form-group",{attrs:{id:"input-group-name",label:"姓名","label-for":"input-name"}},[a("b-form-input",{attrs:{id:"input-name",type:"text",placeholder:"請輸入姓名",required:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("b-form-group",{attrs:{id:"input-group-phone",label:"連絡電話","label-for":"input-phone"}},[a("b-form-input",{attrs:{id:"input-phone",type:"text",placeholder:"請輸入電話",required:""},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),a("b-form-group",{attrs:{id:"input-group-address",label:"收件住址","label-for":"input-address"}},[a("b-form-input",{attrs:{id:"input-address",type:"text",placeholder:"請輸入地址",required:""},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1),a("b-form-group",{attrs:{id:"input-group-email",label:"電子信箱","label-for":"input-email"}},[a("b-form-input",{attrs:{id:"input-email",type:"email",placeholder:"請輸入地址",required:""},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),a("b-form-group",{attrs:{id:"input-group-email",label:"備註","label-for":"input-message"}},[a("b-form-textarea",{attrs:{id:"message",placeholder:"訂單備註",rows:"5","max-rows":"10"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1):t._e()],1),a("b-col",{staticClass:"p-5 d-flex flex-column justify-content-center align-items-center",attrs:{lg:"6"}},[a("h2",{staticClass:"text-center"},[t._v("訂單確認")]),a("div",{staticClass:"w-75 h-100 bg-light mx-auto mt-2 p-3"},[a("b-row",{staticClass:"d-flex justify-content-center p-2"},[a("b-col",[a("h5",[t._v("商品")])]),a("b-col",[a("h5",[t._v("小計")])])],1),a("div",{staticClass:"check-line"}),a("b-row",{staticClass:"mt-3"},[a("b-col",[a("ul",t._l(t.products,(function(e){return a("li",{key:e._id,staticStyle:{"list-style-type":"none"}},[t._v(" "+t._s(e.product.name)+" X "+t._s(e.quantity)+" ")])})),0)]),a("b-col",[a("ul",t._l(t.products,(function(e){return a("li",{key:e._id,staticStyle:{"list-style-type":"none"}},[t._v(" NT$ "+t._s(e.product.price)+" ")])})),0)])],1),a("div",{staticClass:"check-line"}),a("b-row",{staticClass:"mt-3 d-flex justify-content-center align-items-center p-5"},[a("b-col",{attrs:{cols:"6"}},[a("p",{staticClass:"m-auto"},[t._v("付款方式")])]),a("b-col",{attrs:{cols:"6"}},[a("b-form-group",[a("b-form-radio",{attrs:{name:"some-radios",value:"貨到付款"},model:{value:t.pay,callback:function(e){t.pay=e},expression:"pay"}},[t._v("貨到付款")]),a("b-form-radio",{attrs:{name:"some-radios",value:"信用卡"},model:{value:t.pay,callback:function(e){t.pay=e},expression:"pay"}},[t._v("信用卡")]),a("b-form-radio",{attrs:{name:"some-radios",value:"ATM轉帳"},model:{value:t.pay,callback:function(e){t.pay=e},expression:"pay"}},[t._v("ATM轉帳")]),a("b-form-radio",{attrs:{name:"some-radios",value:"Line Pay"},model:{value:t.pay,callback:function(e){t.pay=e},expression:"pay"}},[t._v("Line Pay")])],1)],1)],1),a("div",{staticClass:"check-line"}),a("b-row",{staticClass:"mt-3 d-flex justify-content-center align-items-center p-5"},[a("b-col",[a("p",[t._v("總計")])]),a("b-col",[a("p",[t._v("NT$ "+t._s(t.total))])])],1)],1),a("b-button",{staticClass:"w-50 btn-color text-center mt-5",on:{click:t.checkout}},[t._v("送出訂單")])],1)],1)],1)},s=[],n=a("1da1"),o=(a("96cf"),a("d3b7"),a("b0c0"),{data:function(){return{products:[],fields:[{key:"name",label:"商品"},{key:"price",label:"小計"}],name:"",phone:"",address:"",email:"",message:"",pay:"",show:!0}},computed:{total:function(){return this.products.reduce((function(t,e){return t+e.quantity*e.product.price}),0)}},methods:{checkout:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.post("/orders",{name:t.name,phone:t.phone,address:t.address,message:t.message,pay:t.pay,email:t.email},{headers:{authorization:"Bearer "+t.user.token}});case 3:t.$router.push("/orders"),t.$store.commit("user/updateCart",0),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"結帳失敗"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/users/me/cart",{headers:{authorization:"Bearer "+t.user.token}});case 3:a=e.sent,r=a.data,t.products=r.result,console.log(t.products),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}}),l=o,c=a("2877"),i=Object(c["a"])(l,r,s,!1,null,null,null);e["default"]=i.exports},a434:function(t,e,a){"use strict";var r=a("23e7"),s=a("da84"),n=a("23cb"),o=a("5926"),l=a("07fa"),c=a("7b0b"),i=a("65f0"),u=a("8418"),p=a("1dde"),d=p("splice"),m=s.TypeError,b=Math.max,f=Math.min,v=9007199254740991,h="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var a,r,s,p,d,g,y=c(this),x=l(y),w=n(t,x),_=arguments.length;if(0===_?a=r=0:1===_?(a=0,r=x-w):(a=_-2,r=f(b(o(e),0),x-w)),x+a-r>v)throw m(h);for(s=i(y,r),p=0;p<r;p++)d=w+p,d in y&&u(s,p,y[d]);if(s.length=r,a<r){for(p=w;p<x-r;p++)d=p+r,g=p+a,d in y?y[g]=y[d]:delete y[g];for(p=x;p>x-r+a;p--)delete y[p-1]}else if(a>r)for(p=x-r;p>w;p--)d=p+r-1,g=p+a-1,d in y?y[g]=y[d]:delete y[g];for(p=0;p<a;p++)y[p+w]=arguments[p+2];return y.length=x-r+a,s}})},b0c0:function(t,e,a){var r=a("83ab"),s=a("5e77").EXISTS,n=a("e330"),o=a("9bf2").f,l=Function.prototype,c=n(l.toString),i=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=n(i.exec),p="name";r&&!s&&o(l,p,{configurable:!0,get:function(){try{return u(i,c(this))[1]}catch(t){return""}}})},b789:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-all"},[a("b-row",{staticClass:"w-75 mx-auto mb-2"},[a("b-col",{attrs:{lg:"4"}},[a("p",{staticClass:"cart-list mt-sm-5 mt-lg-0"},[t._v(" 01 "),a("span",[t._v("購物車確認")])]),a("div",{staticClass:"list-under d-none d-md-none d-lg-block"})]),a("b-col",{staticClass:"d-none d-md-none d-lg-block",attrs:{lg:"4"}},[a("p",{staticClass:"cart-list"},[t._v(" 02 "),a("span",[t._v("購買與付款方式")])])]),a("b-col",{staticClass:"d-none d-md-none d-lg-block",attrs:{lg:"4"}},[a("p",{staticClass:"cart-list"},[t._v(" 03 "),a("span",[t._v("完成訂單")])])])],1),a("b-row",{staticClass:"w-75 mx-auto"},[a("b-col",[a("b-table",{staticClass:"w-100 mx-auto text-center cart-table",attrs:{items:t.products,fields:t.fields,"tbody-tr-class":t.rowClass},scopedSlots:t._u([{key:"cell(image)",fn:function(e){return[e.item.product.image?a("img",{attrs:{src:e.item.product.image}}):t._e()]}},{key:"cell(name)",fn:function(e){return[t._v(" "+t._s(e.item.product.name)+" ")]}},{key:"cell(quantity)",fn:function(e){return[a("b-form-select",{staticClass:"w-50",attrs:{id:"sb-locales",options:t.options},on:{input:function(a){return t.updateCart(e.index,e.item.quantity)}},model:{value:e.item.quantity,callback:function(a){t.$set(e.item,"quantity",a)},expression:"data.item.quantity"}})]}},{key:"cell(price)",fn:function(e){return[t._v(" $ "+t._s(e.item.product.price)+" ")]}},{key:"cell(love)",fn:function(){return[a("b-icon",{attrs:{icon:"suit-heart"}})]},proxy:!0},{key:"cell(action)",fn:function(e){return[a("b-button",{staticClass:"bg-transparent del",on:{click:function(a){return t.updateCart(e.index,0)}}},[a("b-icon",{attrs:{icon:"trash"}})],1)]}}])}),0===t.user.cart?a("p",{staticClass:"text-center"},[t._v("購物車是空的")]):t._e()],1)],1),a("b-row",{staticClass:"m-0 w-75 mx-auto"},[a("b-col",{staticClass:"w-50 d-flex justify-content-end",attrs:{lg:"12"}},[a("p",[t._v("共 "+t._s(t.user.cart)+" 件 / ")]),a("p",{staticClass:"ml-2"},[t._v("商品總金額: ")]),a("p",{staticClass:"ml-2 text-danger fw-bold"},[t._v("NT$"+t._s(t.total))])])],1),a("b-row",{staticClass:"w-75 mx-auto"},[a("b-col",{staticClass:"text-right"},[a("b-button",{staticClass:"w-25 btn-color",attrs:{to:"/flower"}},[t._v("繼續購物")])],1),a("b-col",{staticClass:"text-left"},[a("b-button",{staticClass:"w-25 btn-color",attrs:{disabled:0===t.products.length,to:"/checkout"}},[t._v("下一步")])],1)],1)],1)},s=[],n=a("1da1"),o=(a("96cf"),a("a434"),a("d3b7"),{data:function(){return{products:[],fields:[{key:"image",label:"購物清單"},{key:"name",label:""},{key:"quantity",label:"數量"},{key:"price",label:"小計"},{key:"love",label:"收藏"},{key:"action",label:"刪除"}],options:["1","2","3","4","5","6","7","8","9","10"]}},methods:{updateCart:function(t,e){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.api.patch("/users/me/cart",{product:a.products[t].product._id,quantity:e},{headers:{authorization:"Bearer "+a.user.token}});case 3:0===e&&(a.products.splice(t,1),a.$store.commit("user/updateCart",a.user.cart-1)),r.next=10;break;case 6:r.prev=6,r.t0=r["catch"](0),console.log(r.t0),a.$swal({icon:"error",title:"失敗",text:"修改購物車失敗"});case 10:case"end":return r.stop()}}),r,null,[[0,6]])})))()},rowClass:function(t,e){if(t&&"row"===e)return t.product.sell?"":"bg-danger"}},computed:{total:function(){return this.products.reduce((function(t,e){return t+e.quantity*e.product.price}),0)}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/users/me/cart",{headers:{authorization:"Bearer "+t.user.token}});case 3:a=e.sent,r=a.data,t.products=r.result,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),l=o,c=a("2877"),i=Object(c["a"])(l,r,s,!1,null,null,null);e["default"]=i.exports}}]);
//# sourceMappingURL=cart.5057f0f2.js.map